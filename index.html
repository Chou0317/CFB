<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=400, height=640, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>CFB</title>
<link rel="stylesheet" href="style.css">

<script>
    window.onload = () => {
        const accInput = document.getElementById("account"); // å¸³è™Ÿæ¬„ä½
        const pwdInput = document.getElementById("password"); // å¯†ç¢¼æ¬„ä½
        const bindBtn = document.getElementById("bindBtn"); // ç™»å…¥æŒ‰éˆ•
        const unbindBtn = document.getElementById("unbindBtn"); // è§£é™¤æŒ‰éˆ•
        const pushSection = document.getElementById("pushSection"); // æ¨æ’­è¨­å®šå€
        const pushRadios = document.getElementsByName("push"); // æ¨æ’­é¸é …
        const pushBtn = document.getElementById("pushBtn"); // é€å‡ºæŒ‰éˆ•
    
        // --- è¼‰å…¥æ¨æ’­è¨­å®š ---
        function loadPushSetting() {
            const savedPush = localStorage.getItem("push"); // å¾ localStorage å–å¾—å…ˆå‰è¨­å®š
            if (savedPush === "on") {
                // å¦‚æœå…ˆå‰è¨­å®šç‚º "on"ï¼Œé¸æ“‡ "é–‹å•Ÿ" radio
                document.querySelector('input[name="push"][value="on"]').checked = true;
            } else {
                // æ²’æœ‰è¨­å®šæˆ–ç‚º "off"ï¼Œé¸æ“‡ "é—œé–‰" radioï¼ˆé è¨­ï¼‰
                document.querySelector('input[name="push"][value="off"]').checked = true; // off
            }
        }
    
        // --- ç™»å…¥å¾Œè¨­å®šç•«é¢ ---
        function afterBind() {
            accInput.readOnly = true; // å¸³è™Ÿæ¬„ä½ä¸å¯ä¿®æ”¹
            pwdInput.parentElement.style.display = "none"; //éš±è—å¯†ç¢¼æ¬„ä½
            bindBtn.style.display = "none"; // éš±è—ç™»å…¥æŒ‰éˆ•
            unbindBtn.style.display = "block"; // é¡¯ç¤ºè§£é™¤æŒ‰éˆ•
            pushSection.style.display = "block"; // é¡¯ç¤ºæ¨æ’­è¨­å®šå€
            loadPushSetting(); // è¼‰å…¥ä½¿ç”¨è€…å…ˆå‰é¸æ“‡æˆ–é è¨­
        }
    
        // --- è§£é™¤ç¶å®šå¾Œè¨­å®šç•«é¢ ---
        function afterUnbind() {
            accInput.value = ""; // æ¸…ç©ºå¸³è™Ÿæ¬„ä½
            pwdInput.value = ""; // æ¸…ç©ºå¯†ç¢¼æ¬„ä½
            accInput.readOnly = false; // å¸³è™Ÿå¯ç·¨è¼¯
            pwdInput.parentElement.style.display = "block"; // é¡¯ç¤ºå¯†ç¢¼æ¬„ä½
            bindBtn.style.display = "block"; // é¡¯ç¤ºç¶å®šæŒ‰éˆ•
            unbindBtn.style.display = "none"; // éš±è—è§£é™¤æŒ‰éˆ•
            pushSection.style.display = "none"; // éš±è—æ¨æ’­è¨­å®šå€
            document.querySelector('input[name="push"][value="off"]').checked = true; // radio å›é è¨­é—œé–‰
        }

        // åˆå§‹åŒ– guide æ–‡å­—
        function updateGuide() {
            const guide = document.getElementById("guide");
            const savedAcc = localStorage.getItem("account");

            if (savedAcc) {
            // å·²ç¶å®š â†’ ç™»å…¥å¾Œä½¿ç”¨æ–¹æ³•
            guide.innerHTML = `
                <b>ä½¿ç”¨æ–¹æ³•ï¼š</b>
                <ol>
                    <li>éœ€å…ˆæŒ‰ã€Œè§£é™¤ã€ï¼Œå†é‡æ–°è¼¸å…¥å¸³è™Ÿå¯†ç¢¼ã€‚</li>
                    <li>è¨­å®šæ¨æ’­è¨Šæ¯-é–‹å•Ÿæˆ–é—œé–‰ã€‚</li>
                    <li>é–‹å•Ÿå¾Œæœƒæ”¶åˆ°é˜²ç«æ¯¯ç•°å¸¸è­¦è¨Šé€šçŸ¥ã€‚</li>
                </ol>
            `;
            } else {
            // æœªç¶å®š â†’ ç™»å…¥å‰ä½¿ç”¨æ–¹æ³•
            guide.innerHTML = `
                <b>ä½¿ç”¨æ–¹æ³•ï¼š</b>
                    <ol>
                        <li>è¼¸å…¥CFBå¹³å°çš„å¸³è™Ÿèˆ‡å¯†ç¢¼ã€‚</li>
                        <li>æŒ‰ä¸‹ã€Œç¶å®šã€å¾Œï¼Œå°‡æœƒèˆ‡Lineä¸²è¯ã€‚</li>
                    </ol>
                `;
            }
        }
    
        // --- åˆå§‹åŒ–é é¢ ---
        const savedAcc = localStorage.getItem("account");
        updateGuide(); // é¦–æ¬¡è¼‰å…¥å°±æ›´æ–°ä½¿ç”¨æ–¹æ³•
        if (savedAcc) {
            accInput.value = savedAcc; // é¡¯ç¤ºå·²ç¶å®šå¸³è™Ÿ
            afterBind(); // åˆ‡æ›ç•«é¢åˆ°å·²ç¶å®šç‹€æ…‹
        } else {
            accInput.readOnly = false; // å¸³è™Ÿå¯ç·¨è¼¯
            pwdInput.parentElement.style.display = "block"; // é¡¯ç¤ºå¯†ç¢¼æ¬„ä½
            bindBtn.style.display = "block"; // é¡¯ç¤ºç¶å®šæŒ‰éˆ•
            unbindBtn.style.display = "none"; // éš±è—è§£é™¤æŒ‰éˆ•
            pushSection.style.display = "none"; // éš±è—æ¨æ’­è¨­å®šå€
            loadPushSetting(); // é è¨­ radio é—œé–‰
        }
    
        // --- ç¶å®š ---
        bindBtn.onclick = () => {
            const acc = accInput.value.trim(); // å»æ‰å¸³è™Ÿå‰å¾Œç©ºç™½
            const pwd = pwdInput.value.trim(); // å»æ‰å¯†ç¢¼å‰å¾Œç©ºç™½
            // å¦‚æœå¸³è™Ÿæˆ–å¯†ç¢¼ç‚ºç©ºï¼Œæç¤ºä½¿ç”¨è€…
            if (acc === "" || pwd === "") { 
                alert("è«‹è¼¸å…¥å¸³è™Ÿèˆ‡å¯†ç¢¼"); 
                return; 
            }
    
            // å„²å­˜å¸³è™Ÿèˆ‡å¯†ç¢¼åˆ° localStorage
            localStorage.setItem("account", acc);
            localStorage.setItem("password", pwd);
    
            afterBind();  // åˆ‡æ›ç•«é¢åˆ°å·²ç¶å®šç‹€æ…‹
            updateGuide(); // ç¶å®šå¾Œæ›´æ–°ä½¿ç”¨æ–¹æ³•
            alert("ç¶å®šæˆåŠŸ");
        };
    
        // --- è§£é™¤ç¶å®š ---
        unbindBtn.onclick = () => {
            // ç§»é™¤ localStorage çš„å¸³è™Ÿã€å¯†ç¢¼åŠæ¨æ’­è¨­å®š
            localStorage.removeItem("account");
            localStorage.removeItem("password");
            localStorage.removeItem("push"); 
    
            afterUnbind(); // åˆ‡æ›ç•«é¢åˆ°æœªç¶å®šç‹€æ…‹
            updateGuide(); // è§£é™¤ç¶å®šå¾Œæ›´æ–°ä½¿ç”¨æ–¹æ³•
            alert("å·²è§£é™¤ç¶å®š");
        };
    
        // --- é€å‡ºæ¨æ’­è¨­å®š ---
        pushBtn.onclick = () => {
            const selected = [...pushRadios].find(r => r.checked).value;  // æ‰¾å‡ºç›®å‰è¢«é¸å–çš„ radio å€¼
            localStorage.setItem("push", selected); // å„²å­˜åˆ° localStorage
            alert("æ¨æ’­è¨­å®šå·²æ›´æ–°ç‚ºï¼š" + (selected === "on" ? "é–‹å•Ÿ" : "é—œé–‰"));
        };
    };
    </script>
    

<body>
<div class="container">
    <!-- === æ¨™é¡Œå€ === -->
    <div class="title-column">
        <div class="icon-group">
            <div class="icon-left">
                <img src="DPS_logo.jpg" alt="">
            </div>
            <div class="icon-right">
                <img src="fire1.png" alt="">
            </div>
        </div>
        <h1>CFBç›£æ§-LINEæœå‹™</h1>
    </div>

    <!-- === ä½¿ç”¨æ–¹æ³•å€ === -->
    <div class="guide" id="guide"></div>

    <!-- === å¸³è™Ÿå¯†ç¢¼è¼¸å…¥å€ === -->
    <div class="input-group">
        <label for="account">ğŸ‘¤ å¸³è™Ÿ</label>
        <input type="text" id="account" placeholder="è«‹è¼¸å…¥å¸³è™Ÿ">
    </div>
    <div class="input-group">
        <label for="password">ğŸ”’ å¯†ç¢¼</label>
        <input type="password" id="password" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
    </div>

    <!-- === ç¶å®š / è§£é™¤æŒ‰éˆ•å€ === -->
    <div class="btn-area">
        <button class="bind-btn" id="bindBtn">ç™»å…¥</button>
        <button class="unbind-btn" id="unbindBtn">è§£é™¤</button>
    </div>

    <!-- === æ¨æ’­è¨­å®šå€ === -->
    <div class="push-section" id="pushSection">    
        <div class="push-row">
            <span>è¨­å®šæ¨æ’­è¨Šæ¯ï¼š</span>
            <label><input type="radio" name="push" value="on"> é–‹å•Ÿ</label>
            <label><input type="radio" name="push" value="off" checked> é—œé–‰</label>
        </div>
        <button class="push-submit-btn" id="pushBtn">é€å‡º</button>
    </div>

    <!-- === é å°¾ === -->
    <div class="footer">
        <img src="dps.png" alt="dps-icon">
        <span>ä¸­ä¿é˜²ç½ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸ www.dps.tw</span>
    </div>
</div>
</body>
</html>


